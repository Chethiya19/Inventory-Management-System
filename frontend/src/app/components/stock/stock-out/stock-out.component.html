<div class="container py-3">
  <div class="card shadow stock-out-card">
    <div class="card-header bg-danger text-white">
      <h4 class="mb-0"><i class="bi bi-box-arrow-up"></i> Stock Out</h4>
    </div>
    <div class="card-body">

      <div *ngIf="message" class="alert alert-success">{{ message }}</div>
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

      <!-- Stock Out Form -->
      <form class="row g-3 align-items-end">
        <div class="col-md-5">
          <label class="form-label"><i class="bi bi-box"></i> Product</label>
          <select class="form-select" [(ngModel)]="selectedProductId" name="product">
            <option [ngValue]="undefined">-- Select Product --</option>
            <option *ngFor="let p of products" [ngValue]="p.id">
              {{ p.name }} (Current: {{ p.stock_qty }})
            </option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label"><i class="bi bi-dash-circle"></i> Quantity</label>
          <input type="number" class="form-control" [(ngModel)]="quantity" name="quantity" min="1" placeholder="Qty" />
        </div>

        <div class="col-md-4 d-grid">
          <button class="btn btn-danger" type="button" (click)="onRemoveStock()">
            <i class="bi bi-arrow-down-circle-fill"></i> Remove Stock
          </button>
        </div>
      </form>

      <!-- Divider -->
      <hr class="my-4" />

      <!-- Stock Out History Table -->
      <h5><i class="bi bi-clock-history"></i> Stock Out History</h5>
      <div *ngIf="stockOutHistory.length === 0" class="text-muted">No stock out history available.</div>

      <div class="table-responsive" *ngIf="stockOutHistory.length > 0">
        <table class="table table-bordered table-striped table-hover mt-3">
          <thead class="table-danger">
            <tr>
              <th>#</th>
              <th>Product ID</th>
              <th>Product</th>
              <th>Quantity</th>
              <th>Date & Time</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let entry of stockOutHistory; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ entry.Product.id }}</td>
              <td>{{ entry.Product.name }}</td>
              <td>{{ entry.quantity }}</td>
              <!-- <td>{{ entry.createdAt | date: 'short' }}</td> -->
              <td>{{ entry.createdAt | date: 'M/d/y, h:mm a' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>
